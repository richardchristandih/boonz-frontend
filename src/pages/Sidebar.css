/* =========================
   Sidebar.css (refined, cleaned)
   ========================= */

/* ---------- Design tokens ---------- */
:root{
  /* Brand */
  --brand:#FB7E00;
  --brand-900:#D86F00;
  --brand-2:#FFCC3F;

  /* Surfaces */
  --bg:#ffffff;
  --surface:#D1DFD2;
  --bg-soft:var(--surface);

  /* Text & borders */
  --text:#1f2937;
  --muted:#6b7280;
  --border:#ececec;

  /* Shadows */
  --shadow-xs:0 2px 8px rgba(0,0,0,.04);
  --shadow-sm:0 4px 14px rgba(0,0,0,.06);
  --shadow:0 8px 24px rgba(0,0,0,.08);

  /* CTA */
  --cta:#79B4B0;
  --cta-900:#5F9D99;
  --cta-glow:0 10px 28px rgba(121,180,176,.35);

  /* Focus ring */
  --ring:0 0 0 3px rgba(251,126,0,.22);

  /* Logo skeleton */
  --logo-skel-bg:#f1f5f9;
  --logo-skel-shine:rgba(255,255,255,.65);
}

/* Dark mode */
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b0f14;
    --bg-soft:#0f141b;
    --text:#e7edf6;
    --muted:#9aa4b2;
    --border:#1e2630;

    --shadow-xs:0 2px 8px rgba(0,0,0,.35);
    --shadow-sm:0 4px 14px rgba(0,0,0,.4);
    --shadow:0 8px 28px rgba(0,0,0,.5);

    --cta:#79B4B0;
    --cta-900:#5A8E8B;
    --cta-glow:0 10px 26px rgba(121,180,176,.45);

    --logo-skel-bg:#0f141b;
    --logo-skel-shine:rgba(255,255,255,.2);
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *{animation-duration:.001ms!important;animation-iteration-count:1!important;transition-duration:.001ms!important;scroll-behavior:auto!important}
}

/* ---------- Sidebar layout ---------- */
.layout-sidebar{
  width:240px; min-width:240px; height:100dvh;
  background:var(--bg-soft);
  border-right:1px solid var(--border);
  box-sizing:border-box;
  padding:20px;
  display:flex; flex-direction:column; gap:16px;
  position:sticky; top:0;
  transition:width .18s ease,min-width .18s ease,padding .18s ease,background .2s ease,border-color .2s ease;
  will-change:width;
  overflow-y:auto; overscroll-behavior:contain;
  padding-bottom:max(20px, env(safe-area-inset-bottom));
}
@supports not (height:100dvh){ .layout-sidebar{ height:100vh; } }

.layout-sidebar.collapsed{ width:88px; min-width:88px; padding:20px 12px; }

.sidebar-top{
  display:flex; align-items:center; justify-content:space-between;
  min-height:64px;
}

/* ---------- Logo (wrapper + skeleton) ----------
Markup:
<a class="sidebar-logo {loaded ? 'is-loaded' : ''}">
  <img src="..." alt="Brand" />
  <span class="sidebar-logo__skeleton" aria-hidden="true"></span>
</a>
*/
.sidebar-logo{
  position:relative;
  display:inline-flex; align-items:center; justify-content:center;
  inline-size:56px; block-size:56px; /* stable box */
  text-decoration:none; user-select:none; -webkit-tap-highlight-color:transparent;
}
.layout-sidebar.collapsed .sidebar-logo{ display:none; }

/* Image fills the box; fades in when loaded */
.sidebar-logo img{
  display:block;                /* remove baseline gap */
  box-sizing:border-box;
  width:100%; height:100%; object-fit:contain;
  padding:6px; background:#fff; border-radius:12px; box-shadow:var(--shadow-xs);
  opacity:0; transition:opacity .2s ease;
}

/* Shimmer skeleton (click-through, sits above img) */
.sidebar-logo__skeleton{
  position:absolute; inset:0; border-radius:12px; box-shadow:var(--shadow-xs);
  z-index:1; pointer-events:none;
  background:linear-gradient(90deg,
    var(--logo-skel-bg) 0%,
    var(--logo-skel-bg) 40%,
    var(--logo-skel-shine) 50%,
    var(--logo-skel-bg) 60%,
    var(--logo-skel-bg) 100%);
  background-size:200% 100%;
  animation:logoShimmer 1.2s linear infinite;
  transition:opacity .25s ease;
}
@keyframes logoShimmer{ 0%{background-position:200% 0} 100%{background-position:-200% 0} }

.sidebar-logo.is-loaded img{ opacity:1; }
.sidebar-logo.is-loaded .sidebar-logo__skeleton{ opacity:0; animation:none; }

/* ---------- Buttons ---------- */
.sb-icon-btn{
  width:36px; height:36px; border-radius:10px; background:var(--bg); border:1px solid var(--border);
  display:inline-flex; align-items:center; justify-content:center; box-shadow:var(--shadow-xs);
  cursor:pointer; transition:transform .08s ease,background .18s ease,border-color .18s ease,box-shadow .18s ease;
}
.sb-icon-btn:hover{ background:color-mix(in oklab,var(--bg) 92%,#0000); border-color:color-mix(in oklab,var(--border) 70%,var(--text) 30%); }
.sb-icon-btn:active{ transform:translateY(1px); }
.sb-icon-btn:focus-visible{ outline:none; box-shadow:var(--ring); }

.sb-btn{
  border:1px solid var(--border); background:var(--bg); color:var(--text);
  padding:10px 14px; border-radius:12px; font-size:14px; line-height:1;
  display:inline-flex; align-items:center; gap:8px; cursor:pointer; box-shadow:var(--shadow-xs);
  transition:transform .08s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease, color .2s ease;
}
.sb-btn:hover{ background:color-mix(in oklab,var(--bg) 92%,#0000); border-color:color-mix(in oklab,var(--border) 70%,var(--text) 30%); }
.sb-btn:active{ transform:translateY(1px); }
.sb-btn:focus-visible{ outline:none; box-shadow:var(--ring); }

.sb-btn-primary{
  background:var(--brand); border-color:var(--brand); color:#fff;
  box-shadow:0 10px 26px color-mix(in oklab,var(--brand) 40%,#0000);
}
.sb-btn-primary:hover{ background:var(--brand-900); border-color:var(--brand-900); }

.sidebar-actions-stack{ margin-top:auto; display:flex; flex-direction:column; gap:10px; }
.add-product-btn,.add-category-btn{ width:100%; justify-content:center; }

/* ---------- Nav ---------- */
.sidebar-nav{ display:flex; flex-direction:column; gap:12px; }
.nav-link{
  display:flex; align-items:center; gap:12px; text-decoration:none; color:var(--text);
  padding:10px 12px; border-radius:12px; border:1px solid transparent;
  transition:background .2s ease,color .2s ease,border-color .2s ease,box-shadow .2s ease;
}
.nav-link:hover{ background:color-mix(in oklab,var(--bg) 94%,#0000); border-color:var(--border); }
.nav-link:focus-visible{ outline:none; box-shadow:var(--ring); background:color-mix(in oklab,var(--bg) 92%,#0000); }
.nav-link svg{ color:var(--muted); flex:0 0 18px; }
.nav-link.active{
  color:var(--brand);
  background:color-mix(in oklab,var(--brand) 14%,var(--bg));
  border-color:color-mix(in oklab,var(--brand) 30%,var(--border));
  box-shadow:0 8px 22px color-mix(in oklab,var(--brand) 20%,#0000);
}
.nav-link.active svg{ color:var(--brand); }

/* Mobile-only “Add …” pill */
.add-pill{
  background:var(--cta)!important; border-color:var(--cta)!important; color:#fff!important;
  box-shadow:var(--cta-glow)!important; padding:12px 18px; font-weight:600;
}
.add-pill:hover{ background:var(--cta-900)!important; border-color:var(--cta-900)!important; }

/* Collapsed tweaks */
.layout-sidebar.collapsed .brand-text,
.layout-sidebar.collapsed .nav-link span{ display:none; }
.layout-sidebar.collapsed .nav-link{ justify-content:center; padding:10px; }
.layout-sidebar.collapsed .sidebar-actions-stack .sb-btn span{ display:none; }
.layout-sidebar.collapsed .sidebar-actions-stack .sb-btn{ justify-content:center; }

/* Touch polish */
.nav-link,.sb-btn,.sb-icon-btn{ -webkit-tap-highlight-color:transparent; }

/* Make the Add Product button text white */
.sb-btn-primary.add-product-btn{
  color:#fff!important; background:var(--brand); border:none; font-weight:700;
  transition:filter .15s, transform .06s;
}
.sb-btn-primary.add-product-btn:hover{ filter:brightness(.95); }
.sb-btn-primary.add-product-btn:active{ transform:translateY(1px); }

/* Light mode separator (optional) */
@media (prefers-color-scheme: light){ .sidebar-top{ border-bottom:0; } }

/* Short-height desktops */
@media (max-height:580px) and (min-width:901px){
  .sidebar-actions-stack{ margin-top:auto!important; display:flex!important; flex-direction:column!important; gap:8px; }
  .add-product-btn,.add-category-btn{ width:100%; justify-content:center; }
}

/* ---------- Responsive: top bar on mobile ---------- */
@media (max-width:900px){
  .layout-sidebar,
  .layout-sidebar.collapsed{
    width:100%; min-width:0; height:auto; border-right:0;
    padding:max(12px, env(safe-area-inset-top)) 16px 10px 16px;
    position:sticky; top:0; z-index:50; background:var(--bg);
    border-bottom:1px solid var(--border); box-shadow:var(--shadow-sm); gap:12px;
    transition:none; /* no jump on breakpoint flip */
  }
  @supports (backdrop-filter: blur(8px)){
    .layout-sidebar{ background:color-mix(in oklab,var(--bg) 86%,transparent); backdrop-filter:blur(8px); -webkit-backdrop-filter:blur(8px); }
  }

  .sidebar-top{ justify-content:center; min-height:56px; }
  .layout-sidebar.as-topbar .brand-text{ display:none; }
  .layout-sidebar.as-topbar .sidebar-logo{ margin:0 auto; }

  /* Pills: horizontal scroller */
  .sidebar-nav{
    flex-direction:row; gap:10px; overflow-x:auto; -webkit-overflow-scrolling:touch;
    scrollbar-width:none; scroll-snap-type:x proximity; padding-bottom:4px; flex-wrap:nowrap;
  }
  .sidebar-nav::-webkit-scrollbar{ display:none; }

  .nav-link{
    background:#fff; border:1px solid var(--border); border-radius:999px; padding:10px 14px;
    box-shadow:var(--shadow-xs); scroll-snap-align:start; white-space:nowrap; flex:0 0 auto;
  }
  .nav-link svg{ display:none; }
  .add-pill svg{ display:block; }

  .nav-link.active{
    background:var(--brand); border-color:var(--brand); color:#fff;
    box-shadow:0 10px 24px color-mix(in oklab,var(--brand) 35%,#0000);
  }

  .sidebar-toggle{ display:none; }
  .sidebar-actions-stack{ display:none; }

  /* MOBILE LOGO: 56px tall, width auto, no tile */
  .layout-sidebar.as-topbar .sidebar-logo{
    inline-size:auto !important;
    block-size:56px !important;
  }
  .layout-sidebar.as-topbar .sidebar-logo img{
    height:56px !important; width:auto !important; max-width:none; object-fit:contain;
    padding:0 !important; background:transparent !important; border-radius:0 !important; box-shadow:none !important;
  }
}

/* ---------- DESKTOP LOGO: square 56×56 tile ---------- */
@media (min-width:901px){
  .layout-sidebar:not(.as-topbar) .sidebar-logo{
    inline-size:56px; block-size:56px; flex:0 0 56px; aspect-ratio:1 / 1;
  }
  .layout-sidebar:not(.as-topbar) .sidebar-logo img{
    width:100% !important; height:100% !important; max-width:none;
    object-fit:contain; padding:6px; background:#fff; border-radius:12px; box-shadow:var(--shadow-xs);
  }
}
